
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>VR</title>
    <!--Import A-Frame-->
    <script src="https://aframe.io/releases/1.7.0/aframe.min.js"></script>
    <!--A-Frame Extras-->
    <script src="https://cdn.jsdelivr.net/gh/n5ro/aframe-extras@v7.1.0/dist/aframe-extras.min.js"></script>
    <!--Enviroment Components-->
    <script src="https://unpkg.com/aframe-environment-component@1.3.x/dist/aframe-environment-component.min.js"></script>
</head>
<body>
    <!--Main A-Frame Scene-->
    <a-scene>
        <!--Assets, defined here for rendering, then defined in src in objects.-->
        <a-assets>
            <img id="wood-texture" src="images/box-wood-mesh.png">
            <img id="steel-texture" src="images/steel-mesh.png">
            <img id="fire-texture" src="images/fire-mesh.jpg">
            <img id="grass-texture" src="images/grass-texture.jpg">
        </a-assets>
        <!--Objects-->
        <a-box id="box" src="#wood-texture" position="-2.30768 0.52215 -3" rotation="0 45 0" scale=""></a-box>
        <a-sphere id="sphere" src="#fire-texture" position="0.03093 1.25 -5" radius="1.25" 
            animation="property: object3D.rotation.y; to: 122.2; dir: alternate; dur: 2000; loop: true"></a-sphere>
        <a-cylinder id="cylinder" src="#steel-texture" position="2.48107 0.75 -3" radius="0.5" height="1.5"></a-cylinder>
        <!--Plane-->
        <a-plane id="plane" src="#grass-texture" rotation="-90 0 0" width="30" height="30" repeat="10 10"></a-plane>
        <!--Sky-->
        <a-sky id="sky" color="#87CEEB"></a-sky>
        <!--Text-->
        <a-entity text="value: Hello, welcome!; color: #FAFAFA; width: 5; anchor: align"
            position="-0.9 0.2 -3"
            scale="1.5 1.5 1.5">
        </a-entity>

        <!--Lighting-->
        <a-light type="ambient" color="#445451"></a-light>
        <a-light type="point" intensity="7" position="2 4 4"></a-light>
        <!-- Camera-->
        <a-entity id="camera-rig" movement-controls="speed: 0.1">
            <a-entity id="camera" 
                      position="0 1.6 3"
                      camera
                      look-controls
                      thumbstick-movement>
            </a-entity>
            <!-- Laser pointers -->
            <a-entity laser-controls="hand: right"></a-entity>
            <a-entity laser-controls="hand: left"></a-entity>
        </a-entity>

    </a-scene>

    <script>
        AFRAME.registerComponent('thumbstick-movement', {
        init: function () {
            this.moveVelocity = new THREE.Vector3();
            this.speed = 0.2; // Slightly faster for natural movement
            
            // Listen for thumbstick movement
            this.el.addEventListener('thumbstickmoved', (evt) => {
                const { x, y } = evt.detail;
                
                // Get camera direction (but ignore vertical tilt)
                const camera = this.el;
                const direction = new THREE.Vector3();
                camera.object3D.getWorldDirection(direction);
                direction.y = 0;
                direction.normalize();
                
                // Apply movement relative to camera direction
                this.moveVelocity.x = direction.x * y + direction.z * x;
                this.moveVelocity.z = direction.z * y - direction.x * x;
                this.moveVelocity.multiplyScalar(this.speed);
            });
            
            // Stop movement when thumbstick is released
            this.el.addEventListener('thumbstickend', () => {
                this.moveVelocity.set(0, 0, 0);
            });
        },
        
        tick: function () {
            // Apply movement smoothly every frame
            this.el.object3D.position.add(this.moveVelocity);
        }
    });
      </script>

</body>
</html>